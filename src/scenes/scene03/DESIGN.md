## 概要
- **目的**: 金属的な「道」の上をカメラが進み、actual_tickに応じてオブジェクトが生えるシーン
- **レンダリング方式**: WebGPU（three/webgpu）
- **実装方式**: 通常のMeshを配列で管理（WebGPUでInstancedMeshが動的更新できないため）

## 使用技術・ライブラリ
- **WebGPU**: ON
  - レンダリング: three/webgpu
- **ポストプロセッシング**: ON
  - Bloom: OFF（シーン固有で無効化）
  - 色反転エフェクト: ON（Track2）
  - 色収差エフェクト: ON（Track3）
  - グリッチエフェクト: ON（Track4）
- **HDR環境マップ**: ON
  - ファイル: `autumn_field_puresky_1k.hdr`
  - 環境強度: 0.3
  - トーンマッピング露出: 0.6
- **グリッド/ルーラー**: ON
  - 3Dグリッド: ON（GridRuler3D、デフォルトOFF）
  - 床グリッド: 有効（opacity: 0.3）
- **カメラパーティクル**: ON
  - カメラ数: 1台
  - カメラモード: follow（デフォルト）またはlead
  - 移動範囲: Box内（X: ±15, Y: 0-30, Z: -1000-1000）
  - 最大速度: 2.0
  - 最大力: 0.8
  - 摩擦: 0.25（強め）
  - バウンス減衰: 0.3
- **シャドウ**: ON
  - シャドウマップ: 有効（シーン固有）
  - シャドウタイプ: PCFSoftShadowMap
  - シャドウマップサイズ: 2048x2048
- **道（Road）**: ON
  - 長さ: 50,000
  - 幅: 20
  - マテリアル: MeshPhysicalMaterial（金属、clearcoat: 0.7）
- **トラックオブジェクト**: ON
  - Track1: 黒い太め円柱 + ランダムCircle（1-4個）+ 水平Circleエフェクト
  - Track5: 細め円柱 + ランダムCircle（1-3個、一番上はシルバー）
  - Track6: 赤い細いシリンダー
  - Track8: シルバーの曲面金属片（90度部分）
  - Track9: 黒の曲面金属片（120度部分）
  - Track10: グレーの曲面金属片（180度部分）
  - モノリス: 黒い大きなBox（小節ごとに生成）
- **ライティング**: ON
  - アンビエントライト: 0x404050、強度0.3
  - ディレクショナルライト: 0xffffff、強度1.5（メイン、シャドウ有効）
  - フィルライト1: 0x4466aa、強度0.5
  - フィルライト2: 0xaa6644、強度0.4
  - リムライト: 0xaaaaff、強度0.3

## シェーダー
- **particleRender.vert/frag**: パーティクル描画シェーダー（使用状況は要確認）
- **colorUpdate.vert/frag**: パーティクル色更新シェーダー（使用状況は要確認）
- **positionUpdate.vert/frag**: パーティクル位置更新シェーダー（使用状況は要確認）
- **lineRender.vert/frag**: 線描画シェーダー（使用状況は要確認）
- **laserScan.vert/frag**: レーザースキャンシェーダー（使用状況は要確認）
- **backgroundGradient.vert/frag**: 背景グラデーションシェーダー（使用状況は要確認）

## パラメータ
- **道の設定**:
  - 長さ: 50,000
  - 幅: 20
  - 進行速度: 0.15（tickあたり）
- **カメラ設定**:
  - FOV: 50度
  - ニア: 0.1
  - ファー: 2000
  - ターゲット: (0, 1, 0)（followモード）または前方オブジェクト（leadモード）
- **オブジェクト生成位置**:
  - followモード: カメラ位置 + 30
  - leadモード: カメラ位置 + 40
- **Track1オブジェクト**:
  - 円柱半径: 0.5
  - 高さ: 1.5-4.5（velocity依存）
  - スケール: 0.8-1.2（velocity依存）× 1.4
  - Circle数: 1-4個（ランダム）
  - X位置: ノイズで蛇のように（道の幅いっぱい）
- **Track5オブジェクト**:
  - 円柱半径: 0.35
  - 高さ: 0.5-1.5（velocity依存）× 1.3
  - スケール: 0.7-1.0（velocity依存）× 1.5
  - Circle数: 1-3個（ランダム、一番上はシルバー）
  - X位置: ノイズで蛇のように（道の幅いっぱい）
- **Track6オブジェクト**:
  - シリンダー半径: 0.025
  - 高さ: 2-10（velocity依存）× 0.9
- **Track8/9/10オブジェクト**:
  - Track8: 半径0.8、高さ1.5、90度部分
  - Track9: 半径0.6、高さ1.8、120度部分
  - Track10: 半径1.0、高さ1.2、180度部分
  - X位置・角度・高さ: ノイズで蛇のように連続
- **モノリス**:
  - サイズ: 3.5 x 9 x 0.35
  - 生成タイミング: 小節ごと
- **アニメーション**:
  - 生えてくるアニメーション: easeOutCubic、デフォルト500ms
  - Circleエフェクト: 広がって段々と透明になって消える、デフォルト400ms
- **クリーンアップ距離**: 500（カメラの後ろ500ユニット以上離れたら削除）

## インタラクション
- **キーボード操作**:
  - **c/C**: デバッグ情報をコンソールに出力
  - **g/G**: グリッドの表示/非表示
  - **m/M**: カメラモードの切り替え（follow ⇄ lead）
  - **t/T**: テスト生成（Track1/5/6オブジェクトを生成）
  - **h/H**: HUDの表示/非表示
  - **s/S**: 正方形スクリーンショット
  - **y/Y**: 16:9スクリーンショット
  - **r/R**: シーンリセット（キーを離した時）
- **OSCメッセージ**（トラック別）:
  - **Track1**: 黒い太め円柱 + Circleオブジェクト生成
    - デフォルト: ON
    - velocity: 高さとスケールに影響
    - durationMs: アニメーション時間（デフォルト500ms）
  - **Track2**: 色反転エフェクト
    - デフォルト: ON
    - velocity: エフェクト強度（0-127）
    - durationMs: 効果持続時間（デフォルト150ms）
  - **Track3**: 色収差エフェクト
    - デフォルト: ON
    - velocity: エフェクト強度（0-127 → 0.0-1.0）
    - durationMs: 効果持続時間（デフォルト150ms）
  - **Track4**: グリッチエフェクト
    - デフォルト: OFF
    - velocity: エフェクト強度（0-127 → 0.0-0.7）
    - durationMs: 効果持続時間（デフォルト150ms）
  - **Track5**: 細め円柱 + Circleオブジェクト生成
    - デフォルト: ON
    - velocity: 高さとスケールに影響
    - durationMs: アニメーション時間（デフォルト500ms）
  - **Track6**: 赤い細いシリンダー生成
    - デフォルト: ON
    - velocity: 高さに影響
    - durationMs: アニメーション時間（デフォルト500ms）
  - **Track8**: シルバーの曲面金属片生成
    - デフォルト: ON
    - velocity: 高さとスケールに影響
    - durationMs: アニメーション時間（デフォルト500ms）
  - **Track9**: 黒の曲面金属片生成
    - デフォルト: ON
    - velocity: 高さとスケールに影響
    - durationMs: アニメーション時間（デフォルト500ms）
  - **Track10**: グレーの曲面金属片生成
    - デフォルト: ON
    - velocity: 高さとスケールに影響
    - durationMs: アニメーション時間（デフォルト500ms）
- **OSCメッセージ**（その他）:
  - **/actual_tick**: 進行位置を更新
  - **/actual_bar**: 小節が変わったらカメラをランダマイズ
  - **/phase**: phaseが変わったらカメラモードをランダムに切り替え（follow ⇄ lead）

## 実装のポイント
- **Mesh配列管理**: InstancedMeshが動的更新できないため、通常のMeshを配列で管理
- **ノイズによる連続性**: X位置や角度をノイズで蛇のように連続させる（前回位置に加算）
- **生えてくるアニメーション**: オブジェクトは下から上に生えてくる（easeOutCubic）
- **Circleエフェクト**: Track1の水平Circleエフェクトは広がって段々と透明になって消える
- **カメラモード**: followモードは後ろから追いかける、leadモードは前方のオブジェクトを注視
- **注視点の滑らかさ**: leadモードでは注視点の更新頻度を下げて滑らかに（lerpFactor: 0.25）
- **道の移動**: 道はカメラの進行に合わせて移動（消えないように）
- **クリーンアップ**: カメラの後ろ500ユニット以上離れたオブジェクトを削除
- **ジオメトリ・マテリアルの再利用**: 同じジオメトリとマテリアルを複数のオブジェクトで再利用

## 今後の拡張予定
- 特に記載なし（現時点で完成度が高い）
